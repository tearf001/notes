## 单元格位置[](https://docs.univer.ai/zh-CN/guides/sheets/getting-started/cell-data#%E5%8D%95%E5%85%83%E6%A0%BC%E4%BD%8D%E7%BD%AE)

Univer Sheets 中的单元格数据存储在 [IWorksheetData](https://reference.univer.ai/zh-CN/interfaces/IWorkbookData)  的 [cellData](https://reference.univer.ai/zh-CN/interfaces/ICellData)  字段中，cellData 是一个二维 Map 结构，一二级索引分别代表行号和列号，每一个单元格是一个 [ICellData](https://reference.univer.ai/zh-CN/interfaces/ICellData)  对象，包含了单元格值、样式、类型等所有单元格信息。

#cellData 的结构如下 #IWorksheetData

```ts
{
  cellData: {
    // 第一行
    0: {
      // 第一列
      0: { v: 'A1' },      
    },   
  }
}
```

## 单元格信息[](https://docs.univer.ai/zh-CN/guides/sheets/getting-started/cell-data#%E5%8D%95%E5%85%83%E6%A0%BC%E4%BF%A1%E6%81%AF)

完整的单元格信息如下。

| 属性     | 说明                        |
| ------ | ------------------------- |
| v      | 单元格的原始值                   |
| s      | 单元格的样式 id 或者样式对象          |
| t      | 单元格的类型                    |
| p      | 富文本，同时也是一个 📝 Univer Docs |
| f      | 公式                        |
| si     | 公式 ID                     |
| custom | 自定义字段                     |
### 单元格原始值[](https://docs.univer.ai/zh-CN/guides/sheets/getting-started/cell-data#%E5%8D%95%E5%85%83%E6%A0%BC%E5%8E%9F%E5%A7%8B%E5%80%BC)

`cellData.v` 存储了单元格的***原始值***，可以为字符串或者数字。有公式的单元格，`v` 存放公式的计算结果。

如下展示了两种不同的单元格值。
```js
{
  cellData: {
    0: {
      0: { v: 'A1' }, // 字符串
      1: { v: 1 }, //数字
    },
  }
}
```

### 单元格样式[](https://docs.univer.ai/zh-CN/guides/sheets/getting-started/cell-data#%E5%8D%95%E5%85%83%E6%A0%BC%E6%A0%B7%E5%BC%8F)

`cellData.s` 存储了单元格的样式 id 或者样式对象。

如果 `s` 是一个字符串，表示样式 id。Univer Sheets 支持对样式做引用优化，将重复的样式对象存储在 IWorkbookData 的 [styles](https://reference.univer.ai/zh-CN/interfaces/IWorkbookData#styles)  字段中，是一个 Map 结构，每个 key 是样式 id，value 是样式对象。
#IWorkbookData
```js
{
  styles: {
    'random_style_id_1': {
      fs: 12,
      bg: {
        rgb: '#ff0000'
      }
    }
  }
}
```
然后将 id 存储到单元格样式中，达到样式复用的目的。

```js
// IWorksheetData
{
  cellData: {
    0: {
      0: {
        v: 'A1',
        s: 'random_style_id_1'
      },
      1: {
        v: 'B1',
        s: 'random_style_id_1'
      },
    },
  }
}
```

如果 `s` 是一个对象，则表示一个完整的单元格样式对象 [IStyleData](https://reference.univer.ai/zh-CN/interfaces/IStyleData) 。 inline

完整的样式字段如下。

|属性|说明|
|---|---|
|ff|字体|
|fs|字体大小|
|it|是否斜体|
|bl|是否加粗|
|ul|下划线|
|st|删除线|
|ol|上划线|
|bg|背景颜色|
|bd|边框|
|cl|字体颜色|
|va|上标下标|
|tr|文字旋转|
|td|文字方向|
|ht|水平对齐方式|
|vt|垂直对齐方式|
|tb|截断溢出|
|pd|内边距|
|n|数字格式|

### 单元格类型[](https://docs.univer.ai/zh-CN/guides/sheets/getting-started/cell-data#cell-type)

`cellData.t` 是一个枚举 [CellValueType](https://reference.univer.ai/zh-CN/globals#cellvaluetype) ，表示单元格的类型。`1` 表示字符串，`2` 表示数字，`3` 表示布尔值，`4` 表示强制文本，不设置时 Univer 会自动识别。

其中，如果单元格是布尔类型，则 `cellData.v` 的值存储为 `0` 或 `1`，`0` 表示 false，`1` 表示 true。

```ts
// IWorksheetData
{
  cellData: {
    0: {
      0: {
        v: 'A1',
        t: 1 // 字符串
      },
      1: {
        v: 1,
        t: 2 // 数字
      },
      2: {
        v: 1, // TRUE
        t: 3 // 布尔值
      },
      3: {
        v: '012.0',
        t: 4 // 强制文本
      },
    },
  }
}
```
### 富文本[](https://docs.univer.ai/zh-CN/guides/sheets/getting-started/cell-data#%E5%AF%8C%E6%96%87%E6%9C%AC)

`cellData.p` 是一个对象，表示富文本，同时也是一个 Univer Doc。详细了解 [IDocumentData](https://reference.univer.ai/zh-CN/interfaces/IDocumentData) 。💡

当 `p` 和 `v` 同时存在时，只会显示 `p` 的内容。

`cellData.p.body.dataStream` 是富文本的内容。

### 公式[](https://docs.univer.ai/zh-CN/guides/sheets/getting-started/cell-data#%E5%85%AC%E5%BC%8F)

`cellData.f` 是一个字符串，表示公式。
```ts
// IWorksheetData
{
  cellData: {
    0: {
      0: {
        f: '=SUM(A1:B1)' // 求和公式
      },
    },
  }
}
```

### 公式 ID[](https://docs.univer.ai/zh-CN/guides/sheets/getting-started/cell-data#%E5%85%AC%E5%BC%8F-id)

`cellData.si` 是一个字符串，表示公式 ID。Univer Sheets 支持对公式做引用优化，单元格中用 `si` 关联上当前公式后，其他单元格可以通过 `si` 引用到当前公式。注意，`si` 所在单元格的位置必须在引用单元格的右下角，否则导出为 XLSX 时会出现错误。

可以通过 Facade API `range.getFormulas()` 来获取实际的公式，规则是取 `si` 对应的公式 `f` 后，根据当前单元格位置到引用位置的偏移量来计算实际的公式。
```JS
// IWorksheetData
{
  cellData: {
    0: {
      0: {
        f: '=SUM(A1:B1)' // 求和公式
        si: 'random_formula_id_1' // 当前公式的 id
      },
      1: {
        si: 'random_formula_id_1' // 计算时 引用 id 对应的公式
      },
    },
  }
}
```


### 自定义字段[](https://docs.univer.ai/zh-CN/guides/sheets/getting-started/cell-data#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%97%E6%AE%B5)
#custom-celldata

`cellData.custom` 是一个对象，表示自定义字段。其中可以放入任何符合 JSON 格式的数据，用于自定义存储一些额外的信息。 更新 `custom` 数据会覆盖原有的 `custom` 数据，如果你在更新数据时需要保留原有的 `custom` 数据，请提前获取到 `custom` 数据合并成新的数据后再更新。

```JS
// IWorksheetData
{
  cellData: {
    0: {
      0: {
        custom: {
          key: 'value'
        }
      },
    },
  }
}
```